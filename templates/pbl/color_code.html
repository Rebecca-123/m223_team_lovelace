{% extends "layouts/base.html" %}

{% block head%}
{#{% set BITS = 8 %}#}

{% endblock %}
<style>
    table {
        border-collapse: collapse;
    }
    table tr{
        border-bottom: 1px solid black;
    }
</style>

{% block body %}
<table style="width:100%">
    <tr>
        <td>Emil</td>
        <td>Tobias</td>
        <td>Linus</td>
    </tr>
    <tr>
        <td>16</td>
        <td>14</td>
        <td>10</td>
    </tr>
    <tr>
        <td>16</td>
        <td>14</td>
        <td>10</td>
    </tr>
</table>
<script>
const BITS = '{{ BITS }}'; let max = '{{ MAX }}'; let MAX = parseInt(max, 10);
// return string with current value of each bit
function getBits() {
    let bits = "";
    for(let i = 0; i < BITS; i++) {
    bits = bits + document.getElementById('digit' + i).value;
}
return bits;
}
// setter for DOM values
function setConversions(binary) {
    document.getElementById('binary').innerHTML = binary;
// DOM assignment to Octal conversion
    document.getElementById('octal').innerHTML = parseInt(binary, 2).toString(8);
// DOM assignment to Hexadecimal conversion
    document.getElementById('hexadecimal').innerHTML = parseInt(binary, 2).toString(16);
// DOM assignment to Decimal conversion
    document.getElementById('decimal').innerHTML = parseInt(binary, 2).toString(10);
/* Hack: show ASCII printable character(s) for each 8 bits
DOM assignment by converting decimal https://www.w3schools.com/jsref/jsref_fromcharcode.asp
look below ASCII for more ideas of where to make changes
*/
// {#javaScript language to convert ascii number to ascii printable characters#}
// convert hexidecimal to unicode -christinaLee
    let unicode = parseInt(binary, 2).toString(16);
    if (unicode.length > 4) {
        unicode = unicode.substr(unicode.length - 4, 4);
    } else if (unicode.length == 3) {
    unicode = "0" + unicode;
    } else if (unicode.length == 2) {
    unicode = "00" + unicode;
    } else if (unicode.length == 1) {
    unicode = "000" + unicode;
}
    unicode = "U-" + unicode;
    document.getElementById("unicode").innerHTML = unicode;

/* converting binary to RGB (optional hack) */
/* first establishing default RGB values*/
var blue = 0;
var red = 0;
var green = 0;

/* conditionals to convert binary to RGB, depending on # of bits */
if (binary.length < 0 && binary.length < 9) {
    blue = parseInt(binary.substring(0, binary.length), 2).toString(10);
}
else if (binary.length > 8 && binary.length < 17) {
    green = parseInt(binary.substring(0, binary.length - 8), 2).toString(10);
    blue = parseInt(binary.substring(binary.length - 8, binary.length), 2).toString(10);
}
else if (binary.length > 16 && binary.length < 25) {
    red = parseInt(binary.substring(0, binary.length - 16), 2).toString(10);
    green = parseInt(binary.substring(binary.length - 16, binary.length - 8), 2).toString(10);
    blue = parseInt(binary.substring(binary.length - 8, binary.length), 2).toString(10);
}
else if (binary.length >= 25) {
    red = parseInt(binary.substring(binary.length - 24, binary.length - 16), 2).toString(10);
    green = parseInt(binary.substring(binary.length - 16, binary.length - 8), 2).toString(10);
    blue = parseInt(binary.substring(binary.length - 8, binary.length), 2).toString(10);
}
/* call the RGB element and set it equal to a string containing the actual RGB values */
document.getElementById("RGB").innerHTML = "(" + red + "," + green + "," + blue + ")";
}



// algorithm to convert decimal to base using division and remainder
function decimal_2_base(decimal, base) {
let conversion = "";
// loop to convert to base
do {
let digit = decimal % base;
conversion = "" + digit + conversion; // what does this do?
decimal = ~~(decimal / base);         // what does this do?  what is ~~?
}
while (decimal > 0);                  // why while at the end?
// loop to pad with zeros
if (base === 2) {                        // only pad for binary conversions
for (let i = 0; conversion.length < BITS; i++) {
conversion = "0" + conversion;
}
}
return conversion;
}

// toggle selected bit and recalculate
function toggleBit(i) {
//alert("Digit action: " + i );
const dig = document.getElementById('digit' + i);
const image = document.getElementById('bulb' + i);
const butt = document.getElementById('butt' + i);
// Change digit and visual
if (image.src.match("{{ imgBulbOn }}")) {
dig.value = 0;
image.src = "{{ imgBulbOff }}";
butt.innerHTML = "{{ msgTurnOn }}";
} else {
dig.value = 1;
image.src = "{{ imgBulbOn }}";
butt.innerHTML = "{{ msgTurnOff }}";
}
// Binary numbers
const binary = getBits();
setConversions(binary);
}
</script>
{% endblock %}
